define(["backbone"],function(e){var t=Backbone.View.extend({el:document.getElementById("content-editor"),className:"content-editor",tagName:"ul",events:{"keyup input":"inputChanged","keyup textarea":"inputChanged","keydown input":"inputChanged","keydown textarea":"inputChanged","click #toggle-bold":"toggleBold","change .font-picker":"changeFont","change .statics":"changeSrc","change .select-href":"changeHref"},initialize:function(e){_.bindAll(this,"render","clear","inputChanged","toggleBold","changeFont","changeSrc","changeHref","renderFontPicker","renderTextEditing"),this.model=e,this.render()},render:function(){var e=this;this.model.has("content")&&this.model.get("content")!==null&&!this.model.get("content_attribs").has("src")&&this.model.get("type")!="images"&&this.model.get("type")!="buttons"&&(this.el.appendChild(this.renderFontPicker()),this.el.appendChild(this.renderTextEditing())),this.model.get("content_attribs").has("href")&&this.el.appendChild(this.renderHrefInfo()),this.model.get("content_attribs").has("src")&&(this.el.appendChild(this.renderSrcInfo()),this.el.appendChild(this.renderHrefInfo()))},renderHrefInfo:function(){var e=document.createElement("li"),t="content_attribs-href";return temp=Templates.tempHrefSelect,html=_.template(temp,{val:this.model.get("content_attribs").get("href"),hash:t}),e.innerHTML='<span class="key" style="display:block;">Target</span>'+html,e},renderSrcInfo:function(){var e=document.createElement("li"),t="content_attribs-src";return temp=Templates.tempSourceSelect,html=_.template(temp,{val:this.model.get("content_attribs").get("src"),hash:t}),e.innerHTML='<span class="key" style="display:block;">Image Source</span>'+html,e},renderTextEditing:function(){var e=document.createElement("li"),t="content";return html='<textarea id="prop-content">'+this.model.get("content")+"</textarea>",e.innerHTML='<span class="key" style="display:block;">Text</span>'+html,e},renderFontPicker:function(){var e=document.createElement("li"),t=this.model.get("content_attribs").get("style")||"font-size:12px;",n=/font-size:([^]+);/g.exec(t)[1],r=document.createElement("div");r.className="size-picker";var i="content_attribs-style";html='<select id="'+i+'" class="font-picker">'+'<option value="font-size:'+n+';">'+n+"</option>"+'<option value="font-size:10px;">'+"10px"+"</option>"+'<option value="font-size:12px;">'+"12px"+"</option>"+'<option value="font-size:14px;">'+"14px"+"</option>"+'<option value="font-size:16px;">'+"16px"+"</option>"+'<option value="font-size:16px;">'+"18px"+"</option>"+'<option value="font-size:20px;">'+"20px"+"</option>"+'<option value="font-size:24px;">'+"24px"+"</option>"+'<option value="font-size:32px;">'+"32px"+"</option>"+'<option value="font-size:40px;">'+"40px"+"</option>"+'<option value="font-size:48px;">'+"48px"+"</option>"+'<option value="font-size:52px;">'+"52px"+"</option>"+'<option value="font-size:64px;">'+"64px"+"</option>"+'<option value="font-size:72px;">'+"72px"+"</option>"+'<option value="font-size:90px;">'+"90px"+"</option>"+"</select>",r.innerHTML='<span class="key">Font Size</span>'+html;var s=document.createElement("div");return s.className="font-options",s.innerHTML='<span id="toggle-bold" class="option-button"><strong>B</strong></span>',e.appendChild(r),e.appendChild(s),e},inputChanged:function(e){e.stopPropagation();var t=e.target.id.replace("prop-",""),n=t.split("-");n.length==2?this.model.get(n[0]).set(n[1],e.target.value):n.length==1&&this.model.set(n[0],e.target.value)},changeFont:function(e){this.model.get("content_attribs").has("style")||this.model.get("content_attribs").set("style","font-size:12px;");var t=this.model.get("content_attribs").get("style");t=t.replace(/font-size:([a-z0-9]+);/g,e.target.value),this.model.get("content_attribs").set("style",t)},toggleBold:function(e){var t=this.model.get("content_attribs").get("style")||"";t.indexOf("font-weight:bold;")<0?(t+="font-weight:bold;",this.model.get("content_attribs").set("style",t)):(t=t.replace("font-weight:bold;",""),this.model.get("content_attribs").set("style",t))},staticsAdded:function(e,t){_(e).each(function(e){e.name=e.filename,statics.push(e)}),t.model.get("content_attribs").set("src",_.last(e).url)},changeSrc:function(e){var t=this;e.target.value=="upload-image"?iui.openFilePick(t.staticsAdded,t,appId):this.model.get("content_attribs").set("src",e.target.value)},changeHref:function(e){var t=this,n=e.target.value;this.model.get("context")&&(n+="/"+context),this.model.get("content_attribs").set("href",n)},clear:function(){this.el.innerHTML="",this.model=null,this.remove()}});return t});