define(["backbone","app/collections/FormFieldCollection"],function(e,t){var n=e.Model.extend({initialize:function(e,n){if(typeof e=="string"){var r=/\{\{([^\}]+)\}\}/g.exec(e)[1],i=n.get("forms").where({name:r})[0];i||alert("string could not be resolved into a form"),e=i.toJSON()}this.set("name",e.name),this.set("fields",new t),this.set("action",e.action||"create"),this.set("goto",e.goto||"{{Homepage}}"),this.set("belongsTo",e.belongsTo||null);if(e.fields)this.get("fields").add(e.fields);else{var s={name:"Submit",type:"button",label:" ",displayType:"button",placeholder:"Submit",options:[]};this.get("fields").push(s)}this.entity=n},toJSON:function(){var e=_.clone(this.attributes);return e.fields=this.get("fields").toJSON(),e}});return n});