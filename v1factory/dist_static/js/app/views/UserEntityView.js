define(["backbone","app/models/FieldModel","app/models/FormModel","app/views/EntityView","app/views/FormEditorView","app/views/UploadExcelView","app/views/ShowDataView","app/collections/EntityCollection"],function(e,t,n,r,i,s,o,u){var a=r.extend({el:document.getElementById("user-entity"),events:{"change .cb-login":"checkedBox","click .add-property-button":"clickedAdd","submit .add-property-form":"formSubmitted","click .prop-cross":"clickedPropDelete","change .attribs":"changedAttribs","click .remove-form":"clickedFormRemove","click .excel":"clickedUploadExcel","click .show-data":"showData","click .edit-form":"clickedEditForm","click .add-form-button":"clickedAddForm","submit .add-form-form":"formFormSubmitted","blur  .property-name-input":"formSubmitted"},initialize:function(e,t){_.bindAll(this,"render","appendField","clickedAdd","checkedBox","formSubmitted","changedAttribs","addedEntity","clickedDelete","modelRemoved","clickedPropDelete","changedAttribs"),this.el=document.getElementById("user-entity"),this.model=e,this.name=e.get("name"),this.entitiesColl=t,this.model.get("fields").bind("add",this.appendField),this.model.get("forms").bind("add",this.appendForm,this),this.render()},render:function(){var e=this;_(this.model.get("fields").models).each(function(t){if(t.get("name")=="First Name"||t.get("name")=="Last Name"||t.get("name")=="Email")return;var n={};n.name=t.get("name"),n.type=t.get("type"),n.cid=t.cid,n.entityName="User",n.other_models=(new u(appState.entities)).models;var r=_.template(Templates.Property,n);e.$el.find(".property-list").append(r)}),document.getElementById("facebook").checked=this.model.get("facebook"),document.getElementById("linkedin").checked=this.model.get("linkedin"),document.getElementById("local").checked=this.model.get("local");var t="";_(e.model.get("forms").models).each(function(e){t+=_.template(Templates.Form,{form:e})}),e.$el.find(".form-list").append(t)},checkedBox:function(e){this.model.set(e.target.value,e.target.checked)},appendField:function(e){if(e.get("name")=="First Name"||e.get("name")=="Last Name"||e.get("name")=="Email")return;var t={};t.name=e.get("name"),t.cid=e.cid,t.type=e.get("type"),t.entityName="User",t.other_models=this.entitiesColl.models;var n=_.template(Templates.Property,t);$(".property-list",this.el).append(n)},formSubmitted:function(e){e.preventDefault();var n=$(".property-name-input",this.el).val();return n.length!==0&&this.model.get("fields").add(new t({name:n,type:"text",required:!0})),$(".property-name-input",this.el).val(""),$(".add-property-form",this.el).hide(),$(".add-property-button",this.el).fadeIn(),!1},clickedPropDelete:function(e){var t=String(e.target.id||e.target.parentNode.id).replace("delete-","");this.model.get("fields").remove(t),$("#column-"+t).remove()},changedAttribs:function(e){var t=String(e.target.id).split("-"),n=t[1],r=t[0],i=e.target.options[e.target.selectedIndex].value||e.target.value;this.model.get("fields").get(n).set(r,i)}});return a});